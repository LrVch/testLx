"use strict";function ready(){!function(){function e(e,t){var n=t.map(function(e){return l(e)}).join(""),r=document.createElement("div");r.innerHTML=n,r.className="news__container",m.appendChild(r),e&&e()}function t(){u.className="news__loader loaded"}function n(){u.className="news__loader show"}function r(){m.addEventListener("click",i)}function i(e){for(var t=e.target;t!==this;){if(t.hasAttribute("data-toggle-more"))return void s(t,e);t=t.parentNode}}function s(e,t){t.preventDefault();var n=e.parentNode,r=e.querySelector("[data-more-text]");e.hasAttribute("data-open")?(e.removeAttribute("data-open"),n.className="news-item",r.innerHTML="more"):(e.setAttribute("data-open",""),n.className="news-item open",r.innerHTML="hide")}function o(e,t,n){o.count++,o.count!==t&&(console.error("–ò–∑–≤–∏–Ω–∏—Ç–µ, –≤ –¥–∞–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞, –º—ã –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏—Ö –µ—â—ë —Ä–∞–∑"),console.error(e.name),console.error(e.message),n&&n())}function a(e,r){try{var i=JSON.parse(e);r&&r(i)}catch(s){o(s,3,function(){h(a,null,n,t)})}}function l(e){return'<div class="news-item"><div class="news-item__header"><h4 class="news-item__title">'+e.title+'</h4><div class="news-item__date">'+c(new Date(e.date))+'</div></div><div class="news-item__content" data-content><div><p>'+e.text+'</p></div></div><a href="#" data-toggle-more class="news-item__more"><span data-more-text>more</span><span>&nbsp;&gt;</span></a></div>'}function c(e){return d(e.getDate())+"."+d(e.getMonth()+1)+"."+d(e.getFullYear())}function d(e){return e<10?"0"+e:e}function h(e,t,n,r){n&&n();var i=new XMLHttpRequest;i.open("GET",f+"/news"),i.send(),i.onreadystatechange=function(){4==i.readyState&&(r&&r(),200!==i.status?t&&t(i.status,i.statusText)||console.error(i.status+": "+i.statusText):e&&e(i.responseText,p))}}var m=document.querySelector("[data-news]"),u=document.querySelector("[data-news-loader]"),f="http://localhost:4040";if(m){var p=e.bind(null,r);o.count=0,h(a,null,n,t)}}(),function(){function e(t){var n=this;this.config=e.mergeSettings(t),this.selector="string"==typeof this.config.selector?document.querySelector(this.config.selector):this.config.selector,this.selectorWidth=this.selector.offsetWidth,this.innerElements=[].slice.call(this.selector.children),this.transformProperty=e.webkitOrNot(),this.initState=!1,["resizeHandler","mouseenterHandler","mouseleaveHandler","transitionendHandler"].forEach(function(e){n[e]=n[e].bind(n)}),this.init()}e.mergeSettings=function(e){var t={selector:".lenta",duration:200,silence:1700,delay:1e3,easing:"ease-out",onInit:function(){},onChange:function(){}},n=e;for(var r in n)t[r]=n[r];return t},e.webkitOrNot=function(){document.documentElement.style;return"transform"},e.prototype.init=function(){if(window.addEventListener("resize",this.resizeHandler),null===this.selector)throw new Error("Something wrong with your selector üò≠");this.selector.addEventListener("mouseenter",this.mouseenterHandler),this.selector.addEventListener("mouseleave",this.mouseleaveHandler),this.createRezerv(),this.sliderFrame=document.createElement("div"),this.sliderFrame.className="lenta__inner",this.setTransform(this.config.duration,this.config.easing),this.setTranslate(0);for(var e=document.createDocumentFragment(),t=0;t<this.innerElements.length;t++)e.appendChild(this.createFrameItem(this.innerElements[t]));this.sliderFrame.appendChild(e),this.selector.innerHTML="",this.selector.appendChild(this.sliderFrame),this.selector.querySelector(".lenta__inner").addEventListener("transitionend",this.transitionendHandler),this.frameItemWidth=this.selector.querySelector(".lenta__frame").offsetWidth,this.sliderFrame.style.width=this.frameItemWidth*this.innerElements.length+"px",this.setInitState(),this.resolveSlidesNumber()},e.prototype.resolveSlidesNumber=function(){if(this.checkIfMoreItemsIsNeed().is)return void this.createMoreFrameItems()},e.prototype.startMove=function(e){var t=this;this.startTimerId=setTimeout(function(){t.moveLenta(),t.transitionendHandler(),t.timerId=setInterval(function(){t.moveLenta(),t.transitionendHandler()},t.config.duration+t.config.silence+200)},e)},e.prototype.stopLenta=function(){clearTimeout(this.startTimerId),clearInterval(this.timerId)},e.prototype.moveLenta=function(){this.setTransform(this.config.duration,this.config.easing);var e=Math.abs(+this.sliderFrame.style[this.transformProperty].slice(11,-3));this.setTranslate(e+this.frameItemWidth)},e.prototype.setTransform=function(e,t){this.sliderFrame.style.webkitTransition="transform "+e+"ms "+t,this.sliderFrame.style.transition="transform "+e+"ms "+t},e.prototype.setTranslate=function(e){this.sliderFrame.style[this.transformProperty]="translateX(-"+e+"px)",this.sliderFrame.style["-ms-"+this.transformProperty]="translateX(-"+e+"px)",this.sliderFrame.style["-mos-"+this.transformProperty]="translateX(-"+e+"px)"},e.prototype.transitionendHandler=function(t){++e.transitionendHandlerCounter,2===e.transitionendHandlerCounter&&(e.transitionendHandlerCounter=0,this.loopItems())},e.transitionendHandlerCounter=0,e.prototype.loopItems=function(){var e=this.selector.querySelector(".lenta__inner").firstElementChild,t=this.selector.querySelector(".lenta__inner");t.appendChild(e),this.setTransform(0,this.config.easing),this.setTranslate(0),this.config.onChange.call(this)},e.prototype.mouseenterHandler=function(){this.stopLenta()},e.prototype.mouseleaveHandler=function(){this.startMove(200)},e.prototype.createFrameItem=function(e){var t=document.createElement("div"),n=document.createElement("img"),r=document.createElement("div"),i=e.getAttribute("data-src");return n.src=i,n.className="lenta__img",t.className="lenta__frame",r.className="lenta__img-visible",r.style.backgroundImage="url("+i+")",this.imgErrorHandler(n,r),t.appendChild(n),t.appendChild(r),t},e.prototype.imgErrorHandler=function(e,t){var n="img/image-error.jpg";e.onerror=function(r){e.src=n,t.style.backgroundImage="url("+n+")"}},e.prototype.createMoreFrameItems=function(){var e=this.checkIfMoreItemsIsNeed().count,t=this.checkIfMoreItemsIsNeed().innerElementsLendth,n=this.rezerv.splice(0,e);this.sliderFrame.style.width=this.frameItemWidth*(t+e)+10*this.frameItemWidth+"px";var r=document.createDocumentFragment();n.forEach(function(e){r.appendChild(this.createFrameItem(e))},this),this.sliderFrame.appendChild(r),this.setInitState()},e.prototype.setInitState=function(){this.initState||(this.config.onInit.call(this),this.initState=!0,this.selector.style.visibility="visible",this.startMove(this.config.delay))},e.prototype.checkIfMoreItemsIsNeed=function(){var e=this.selector.querySelector(".lenta__inner").children.length,t=(this.selector.offsetWidth-this.frameItemWidth*e)/this.frameItemWidth+3;return{count:parseInt(t),innerElementsLendth:e,is:t>1}},e.prototype.createRezerv=function(){for(var e=100/this.innerElements.length,t=[],n=0;n<e;n++)t=t.concat(this.innerElements);this.rezerv=t},e.prototype.resizeHandler=function(){this.resolveSlidesNumber()},window.Lenta=e}();new Lenta({duration:500,silence:1700,delay:1500,onInit:function(){console.log("init")},onChange:function(){console.log("onChange")}})}document.addEventListener("DOMContentLoaded",ready);